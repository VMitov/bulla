{{ $menus := .Site.Menus }}
{{ $currentPage := . }}

{{ range .Site.Params.sidebarMenus }}
    {{ $menuID := .menu }}

    {{ if .label }}
        <p class="menu-label">{{ .label }}</p>
    {{ end }}

    <ul class="menu-list">
        {{ range (index $menus .menu) }}
        <li>
            <a href="{{ .URL }}" class="{{if $currentPage.IsMenuCurrent $menuID . }}is-active{{end}} {{if $currentPage.HasMenuCurrent $menuID . }}has-active{{end}} {{ if .HasChildren }}has-children{{ end }}">
                {{ .Pre }} {{ .Name }}
            </a>

            {{ if .HasChildren }}
            <ul class="sub-menu">
                {{ range .Children }}
                <li>
                    <a href="{{ .URL }}" class="{{ if $currentPage.IsMenuCurrent $menuID . }}is-active{{ end }}">{{ .Pre }} {{ .Name }}</a>

                    {{ if .HasChildren }}
                    <ul class="sub-menu">
                        {{ range .Children }}
                        <li>
                            <a href="{{ .URL }}" class="{{ if $currentPage.IsMenuCurrent $menuID . }}is-active{{ end }}">{{ .Pre }} {{ .Name }}</a>
                        </li>
                        {{ end }}
                    </ul>
                    {{ end}}
                </li>
                {{ end }}
            </ul>
            {{ end}}
        </li>
        {{ end }}
    </ul>
{{ end }}
